<!-- index.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerenciador de Atalhos</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      padding: 1rem;
      background-color: #f8f9fa;
    }
    .message-box {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #fff;
      padding: 0.75rem 1rem;
      margin-bottom: 0.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }
    .message-box:hover {
      background-color: #f1f1f1;
    }
    .message-text {
      flex-grow: 1;
      margin-right: 1rem;
      white-space: pre-wrap;
    }
    .btn-group-sm > .btn {
      padding: 0.25rem 0.5rem;
    }
    #messages-container {
      max-height: 70vh;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="mb-4">Gerenciador de Atalhos</h1>

    <form id="shortcut-form" class="row g-3 mb-4">
      <div class="col-md-4">
        <input type="text" id="shortcut" class="form-control" placeholder="Atalho (ex: bomdia)" required />
      </div>
      <div class="col-md-6">
        <textarea id="message" class="form-control" rows="1" placeholder="Mensagem" required></textarea>
      </div>
      <div class="col-md-2 d-grid">
        <button type="submit" class="btn btn-primary">Adicionar</button>
      </div>
    </form>

    <div class="input-group mb-3">
      <input type="text" id="search" class="form-control" placeholder="Buscar atalho ou mensagem" />
    </div>

    <div id="messages-container"></div>
  </div>

  <script>
    const form = document.getElementById('shortcut-form');
    const shortcutInput = document.getElementById('shortcut');
    const messageInput = document.getElementById('message');
    const searchInput = document.getElementById('search');
    const messagesContainer = document.getElementById('messages-container');

    let shortcuts = JSON.parse(localStorage.getItem('shortcuts') || '{}');

    function renderMessages(filter = '') {
      messagesContainer.innerHTML = '';
      const entries = Object.entries(shortcuts)
        .filter(([key, msg]) =>
          key.toLowerCase().includes(filter.toLowerCase()) ||
          msg.toLowerCase().includes(filter.toLowerCase())
        )
        .sort((a, b) => a[0].localeCompare(b[0]));

      entries.forEach(([shortcut, message]) => {
        const div = document.createElement('div');
        div.className = 'message-box';

        const text = document.createElement('div');
        text.className = 'message-text';
        text.textContent = `/${shortcut} → ${message}`;

        const btnGroup = document.createElement('div');
        btnGroup.className = 'btn-group btn-group-sm';

        const copyBtn = document.createElement('button');
        copyBtn.className = 'btn btn-outline-primary';
        copyBtn.textContent = 'Copiar';
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(message);
        };

        const renameBtn = document.createElement('button');
        renameBtn.className = 'btn btn-outline-secondary';
        renameBtn.textContent = 'Renomear';
        renameBtn.onclick = () => {
          const newKey = prompt('Novo nome do atalho:', shortcut);
          if (newKey && newKey !== shortcut) {
            shortcuts[newKey] = message;
            delete shortcuts[shortcut];
            saveAndRender();
          }
        };

        const editBtn = document.createElement('button');
        editBtn.className = 'btn btn-outline-success';
        editBtn.textContent = 'Editar';
        editBtn.onclick = () => {
          const newMsg = prompt('Editar mensagem:', message);
          if (newMsg !== null) {
            shortcuts[shortcut] = newMsg;
            saveAndRender();
          }
        };

        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'btn btn-outline-danger';
        deleteBtn.textContent = 'Remover';
        deleteBtn.onclick = () => {
          if (confirm(`Deseja remover o atalho /${shortcut}?`)) {
            delete shortcuts[shortcut];
            saveAndRender();
          }
        };

        btnGroup.append(copyBtn, renameBtn, editBtn, deleteBtn);
        div.append(text, btnGroup);
        messagesContainer.appendChild(div);
      });
    }

    function saveAndRender() {
      localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
      renderMessages(searchInput.value);
    }

    form.onsubmit = (e) => {
      e.preventDefault();
      const key = shortcutInput.value.trim();
      const msg = messageInput.value.trim();
      if (!key || !msg) return;
      if (shortcuts[key]) {
        if (!confirm('Esse atalho já existe. Deseja sobrescrevê-lo?')) return;
      }
      shortcuts[key] = msg;
      shortcutInput.value = '';
      messageInput.value = '';
      saveAndRender();
    };

    searchInput.oninput = () => renderMessages(searchInput.value);

    renderMessages();
  </script>
</body>
</html>
